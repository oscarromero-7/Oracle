COL CONCEPTO FORMAT A50
SET LINESIZE 150
SELECT
    O.FECHA,
    CONCAT(CONCAT(CONCAT(CONCAT('OPERACION: ', O.TIPO_OPERACION), ' '), O.CONDICIONPAGO), ' Nro ') || '001-'||
    LPAD(O.LOCALIDAD, 3, '0') || '-'  || LPAD(O.NUMERO_FACTURA, 7, '0') AS CONCEPTO,
    TO_CHAR(DECODE(O.TIPO_OPERACION,'COMPRA',O.MONTO_TOTAL,0),'999,999,999') AS "MONTO DEBITO",
    TO_CHAR(DECODE(O.TIPO_OPERACION,'VENTA',O.MONTO_TOTAL,0),'999,999,999') AS "MONTO CREDITO"
FROM(
	SELECT
   		 V.FECHA AS FECHA,
    		'VENTA' AS TIPO_OPERACION,
    		DECODE(V.TIPO_VENTA,'CO','CONTADO','CR','CREDITO','OTRO MEDIO PAGO') AS CONDICIONPAGO,
    		P.ID_LOCALIDAD AS LOCALIDAD,
    		V.NUMERO_FACTURA,
    		TO_CHAR(DECODE(P.TIPO_PERSONA,'F',P.CEDULA,'J',P.RUC,'NO TIENE DOCUMENTO')) AS DOCUMENTO,
		V.MONTO_TOTAL AS "MONTO_TOTAL"
	FROM
    	    B_VENTAS V
	INNER JOIN B_PERSONAS P ON P.ID = V.ID_CLIENTE
	WHERE
    		EXTRACT(YEAR FROM V.FECHA) = 2018 AND EXTRACT(MONTH FROM V.FECHA) BETWEEN 1 AND 6
	UNION ALL
	SELECT
            	C.FECHA AS FECHA,
            	'COMPRA' AS TIPO_OPERACION,
            	TO_CHAR(DECODE(C.ID_CONDICION,1,'CONTADO',2,'CREDITO','OTRO MEDIO PAGO')) AS CONDICIONPAGO,
            	P.ID_LOCALIDAD AS LOCALIDAD,
            	C.ID AS NUMERO_FACTURA,
	    	TO_CHAR(DECODE(P.TIPO_PERSONA,'F',P.CEDULA,'J',P.RUC,'NO TIENE DOCUMENTO')) AS DOCUMENTO,
		C.MONTO_TOTAL AS "MONTO_TOTAL"
        FROM
            B_COMPRAS C
	INNER JOIN B_PERSONAS P ON P.ID = C.ID_PROVEEDOR
        WHERE
            EXTRACT(YEAR FROM C.FECHA) = 2018 AND EXTRACT(MONTH FROM C.FECHA) BETWEEN 1 AND 6) O
ORDER BY O.FECHA
/
