COL "CONCEPTO" FORMAT A20
SET LINESIZE 150
COL "DEBITO" FORMAT 999,999,999
COL "CREDITO" FORMAT 999,999,999
SELECT DD.ID AS "ID_ASIENTO",
	DC. FECHA AS "FECHA",
	DC.CONCEPTO AS "CONCEPTO",
	DD.NRO_LINEA AS "NRO LINEA",
	DD.CODIGO_CTA AS "CODIGO CUENTA",
	C.NOMBRE_CTA AS "NOMBRE CUENTA",
	CASE WHEN DEBE_HABER = 'D' THEN Importe ELSE 0 END AS DEBITO,
    	CASE WHEN DEBE_HABER = 'C' THEN Importe ELSE 0 END AS CREDITO
FROM B_DIARIO_DETALLE DD
INNER JOIN B_DIARIO_CABECERA DC ON DC.ID = DD.ID
INNER JOIN B_CUENTAS C ON C.CODIGO_CTA = DD.CODIGO_CTA
WHERE EXTRACT(YEAR FROM DC.FECHA) = 2019
ORDER BY DC.FECHA, DD.NRO_LINEA
/
