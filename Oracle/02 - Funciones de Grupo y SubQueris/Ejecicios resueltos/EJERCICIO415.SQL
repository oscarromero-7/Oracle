
User
SELECT E.CEDULA,
	E.NOMBRE||' '||E.APELLIDO AS "NOMBRE Y APELLIDO",
	EXTRACT(YEAR FROM SYSDATE)-EXTRACT(YEAR FROM E.FECHA_ING) AS "ANTIGUEDAD",
	(SELECT COUNT(DISTINCT PA2.ID)
		FROM B_POSICION_ACTUAL PA2
		WHERE E.CEDULA = PA2.CEDULA 
		AND PA2.FECHA_INI BETWEEN E.FECHA_ING AND E.FECHA_ING + INTERVAL '5' YEAR
		GROUP BY E.FECHA_ING) AS CANTIDAD_CARGOS,
	TO_CHAR(NVL(ROUND((SELECT AVG(CS2.ASIGNACION) 
				FROM B_POSICION_ACTUAL PA2
				LEFT JOIN B_CATEGORIAS_SALARIALES CS2 ON PA2.COD_CATEGORIA = CS2.COD_CATEGORIA
				WHERE E.CEDULA = PA2.CEDULA 
				AND PA.FECHA_INI BETWEEN E.FECHA_ING AND E.FECHA_ING + INTERVAL '5' YEAR)),0),'999G999G999') AS PROMEDIO_SALARIAL
FROM B_EMPLEADOS E
LEFT JOIN B_POSICION_ACTUAL PA ON E.CEDULA = PA.CEDULA
LEFT JOIN B_CATEGORIAS_SALARIALES CS ON PA.COD_CATEGORIA = CS.COD_CATEGORIA
GROUP BY E.CEDULA,E.NOMBRE||' '||E.APELLIDO,EXTRACT(YEAR FROM SYSDATE)-EXTRACT(YEAR FROM E.FECHA_ING)
ORDER BY E.CEDULA
