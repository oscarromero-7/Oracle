COL TELEFONO FORMAT A10
SELECT DECODE(P.TIPO_PERSONA,'F',P.CEDULA,'J',P.RUC,'SIN_DOCUMENTO') AS "DOCUMENTO",
	P.NOMBRE||' '||P.APELLIDO AS "NOMBRE Y APELLIDO",
	TO_CHAR(P.TELEFONO) AS "TELEFONO",
	P.CORREO_ELECTRONICO AS "EMAIL",
	TO_CHAR(NVL(( SELECT SUM(PP.MONTO_CUOTA)
	  FROM B_VENTAS V 
	  INNER JOIN B_PLAN_PAGO PP ON V.ID = PP.ID_VENTA AND PP.FECHA_PAGO IS NULL
	  WHERE V.ID_CLIENTE = P.ID AND UPPER(V.TIPO_VENTA) = 'CR'),0),'999G999G999') AS "MONTO DEUDA"
FROM B_PERSONAS P
ORDER BY "MONTO DEUDA" DESC
FETCH FIRST 3 ROWS ONLY
/
