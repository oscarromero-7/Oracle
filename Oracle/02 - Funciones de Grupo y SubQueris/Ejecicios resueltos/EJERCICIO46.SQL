COL ARTICULO FORMAT A40
SELECT
	A.ID,
    	A.NOMBRE AS "ARTICULO",
    	SUM(DC.CANTIDAD) AS "CANTIDAD_COMPRAS",
    	SUM(DC.CANTIDAD * DC.PRECIO_COMPRA) AS "MONTO_COMPRAS",
	SUM(DV.CANTIDAD) AS "CANTIDAD_VENTAS",
	SUM(DV.CANTIDAD * DV.PRECIO) AS "MONTO_VENTAS"
FROM
    B_ARTICULOS A
LEFT OUTER JOIN
   	 B_DETALLE_COMPRAS DC ON A.ID = DC.ID_ARTICULO
LEFT OUTER JOIN
    	B_COMPRAS C ON DC.ID_COMPRA = C.ID AND EXTRACT(YEAR FROM C.FECHA) = 11
LEFT OUTER JOIN
	B_DETALLE_VENTAS DV ON A.ID = DV.ID_ARTICULO
LEFT OUTER JOIN
	B_VENTAS V ON DV.ID_VENTA = V.ID AND EXTRACT(YEAR FROM V.FECHA) = 11
GROUP BY
    A.ID, A.NOMBRE
ORDER BY
    A.ID
/