COL NOMBRE_AREA FORMAT A30
SELECT
	LPAD(' ', 5* (LEVEL-1)) || TO_CHAR(BAR.ID,'000009') ID,
	BAR.NOMBRE_AREA,
	(SELECT TO_CHAR(NVL(SUM (PL.LIQUIDO_COBRADO),0),'999,999,999') AS "MONTO_LIQ"
 	FROM B_AREAS A
 	LEFT JOIN B_POSICION_ACTUAL P
 		ON A.ID=P.ID_AREA AND P.FECHA_FIN IS NULL
	LEFT JOIN B_EMPLEADOS E
		ON P.CEDULA = E.CEDULA
	LEFT JOIN B_PLANILLA PL 
		ON E.CEDULA = PL.CEDULA
 	WHERE A.ID = BAR.ID
 	GROUP BY A.ID
 	) AS "MONTO_LIQ",
	(SELECT TO_CHAR(NVL(SUM(CANTIDAD),0),'999,999,999')
 	FROM (SELECT A.ID, A.ID_AREA_SUPERIOR,A.NOMBRE_AREA, SUM (PL.LIQUIDO_COBRADO) AS CANTIDAD
 		FROM B_AREAS A
 		LEFT JOIN B_POSICION_ACTUAL P
 			ON A.ID=P.ID_AREA AND P.FECHA_FIN IS NULL
		LEFT JOIN B_EMPLEADOS E
			ON P.CEDULA = E.CEDULA
		LEFT JOIN B_PLANILLA PL 
			ON E.CEDULA = PL.CEDULA
 		GROUP BY A.ID, A.ID_AREA_SUPERIOR,A.NOMBRE_AREA
 		)A
 	CONNECT BY PRIOR A.ID = A.ID_AREA_SUPERIOR
 	START WITH A.ID = BAR.ID
	) AS TOTAL_LIQ
FROM B_AREAS BAR
CONNECT BY PRIOR BAR.ID = BAR.ID_AREA_SUPERIOR
START WITH BAR.ID_AREA_SUPERIOR IS NULL
/
