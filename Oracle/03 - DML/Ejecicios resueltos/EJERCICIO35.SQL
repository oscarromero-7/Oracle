MERGE INTO BONIFICACION B
USING (
    SELECT 
        V.CEDULA_VENDEDOR AS VENDEDOR,
        NVL(SUM(A.PRECIO * A.PORC_IVA), 0) AS VENTAS
    FROM 
        B_VENTAS V
    INNER JOIN 
        B_DETALLE_VENTAS DV ON V.ID = DV.ID_VENTA
    INNER JOIN 
        B_ARTICULOS A ON DV.ID_ARTICULO = A.ID
    GROUP BY 
        V.CEDULA_VENDEDOR
) E
ON (B.CEDULA_VENDEDOR = E.VENDEDOR)
WHEN MATCHED THEN
    UPDATE SET B.BONIFICACION = ROUND(E.VENTAS)
WHEN NOT MATCHED THEN
    INSERT (CEDULA_VENDEDOR, BONIFICACION)
    VALUES (E.VENDEDOR, ROUND(E.VENTAS));
