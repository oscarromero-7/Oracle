CREATE OR REPLACE VIEW v_estadistica_articulos AS
(SELECT
    'COMPRAS' AS Tipo_Operacion,
    SUM(CASE WHEN EXTRACT(MONTH FROM C.FECHA) BETWEEN 1 AND 6 THEN C.MONTO_TOTAL ELSE 0 END) AS Monto_Primer_Semestre,
    SUM(CASE WHEN EXTRACT(MONTH FROM C.FECHA) BETWEEN 7 AND 12 THEN C.MONTO_TOTAL ELSE 0 END) AS Monto_Segundo_Semestre
FROM B_COMPRAS C)
UNION ALL
(SELECT 
    'VENTAS' AS TIPO_OPERACION,
    SUM(CASE WHEN EXTRACT(MONTH FROM V.FECHA) BETWEEN 1 AND 6 THEN V.MONTO_TOTAL ELSE 0 END) AS Monto_PRIMER_SEMESTRE,
    SUM(CASE WHEN EXTRACT(MONTH FROM V.FECHA) BETWEEN 7 AND 12 THEN V.MONTO_TOTAL ELSE 0 END) AS Monto_SEGUNDO_SEMESTRE
FROM 
    B_VENTAS V)